<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manbaga Comics & Games - E-commerce</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gagalin&family=Bebas+Neue&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Stile di base per il body */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f0f0;
            color: #2c3e50;
            margin: 0;
            padding: 0;
        }

        /* Stile per l'header */
        .header {
            background-color: #e74c3c;
            color: white;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 5px solid #000;
            position: relative;
            z-index: 10;
        }
        .header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 10px;
            background: linear-gradient(90deg, #000 50%, transparent 50%);
            background-size: 20px 10px;
            z-index: -1;
        }
        .header h1 {
            font-family: 'Gagalin', cursive;
            margin: 0;
            letter-spacing: 2px;
            text-shadow: 2px 2px #34495e;
        }
        .search-container {
            display: flex;
            align-items: center;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: white;
        }
        .search-bar {
            border: none;
            padding: 8px 12px;
            outline: none;
            font-size: 1em;
            font-family: 'Roboto', sans-serif;
        }
        .search-btn {
            background-color: #3498db;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 1em;
            color: white;
        }
        .header nav a {
            color: white;
            text-decoration: none;
            margin-left: 20px;
            font-weight: bold;
            font-family: 'Bebas Neue', sans-serif;
            transition: color 0.3s;
        }
        .header nav a:hover {
            color: #2c3e50;
        }
        
        /* Stile per il contenuto principale */
        .main-content {
            padding: 40px;
            text-align: center;
            display: block; /* Visibile di default */
        }
        h2 {
            font-family: 'Gagalin', cursive;
            font-size: 2.5em;
            color: #c0392b;
            text-shadow: 2px 2px #bdc3c7;
            margin-top: 40px;
        }
        .booking-section, .product-grid {
            background-color: #fff;
            border: 4px solid #000;
            border-radius: 10px;
            padding: 40px;
            box-shadow: 8px 8px 0px #34495e;
            max-width: 900px;
            margin: 60px auto;
            text-align: center;
        }
        .table-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .table {
            background-color: #bdc3c7;
            border: 2px solid #000;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            position: relative;
        }
        .table:hover {
            transform: scale(1.05);
            background-color: #95a5a6;
        }
        .table.available {
            background-color: #2ecc71;
            color: white;
        }
        .table.booked {
            background-color: #e74c3c;
            color: white;
            cursor: not-allowed;
            pointer-events: none;
        }
        .table.selected {
            border: 4px solid #3498db;
            box-shadow: 0 0 15px #3498db;
        }
        .booking-details {
            display: none;
            margin-top: 20px;
            text-align: left;
        }
        .booking-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .booking-form input, .booking-form button {
            width: 100%;
            padding: 10px;
            border: 2px solid #000;
            border-radius: 5px;
            font-family: 'Roboto', sans-serif;
            box-sizing: border-box;
        }
        .booking-form button {
            background-color: #27ae60;
            color: white;
            cursor: pointer;
            grid-column: 1 / 3;
            transition: background-color 0.3s;
        }
        .booking-form button:hover {
            background-color: #2ecc71;
        }
        
        /* Stile delle card prodotto */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        .product-card {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            border: 4px solid #000;
            box-shadow: 8px 8px 0px #34495e;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 12px 12px 0px #34495e;
        }
        .product-gallery {
            position: relative;
        }
        .product-gallery img {
            max-width: 100%;
            height: auto;
            border: 2px solid #000;
            border-radius: 5px;
        }
        .thumbnail-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        .thumbnail {
            width: 60px;
            height: 60px;
            border: 2px solid #000;
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s;
        }
        .thumbnail.active, .thumbnail:hover {
            border-color: #e74c3c;
            transform: scale(1.1);
        }
        .product-card h3 {
            font-family: 'Gagalin', cursive;
            margin: 15px 0 5px;
            color: #34495e;
        }
        .product-card .price {
            font-size: 1.5em;
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 15px;
        }
        .add-to-cart-btn {
            background-color: #3498db;
            color: white;
            border: 2px solid #000;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            font-family: 'Bebas Neue', sans-serif;
            transition: background-color 0.3s;
            box-shadow: 3px 3px 0px #000;
        }
        .add-to-cart-btn:hover {
            background-color: #2980b9;
        }

        /* Footer */
        .footer {
            background-color: #2c3e50;
            color: #bdc3c7;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-top: 5px solid #000;
        }

        /* Modale di Login/Signup */
        .auth-modal {
            display: none;
            position: fixed;
            z-index: 20;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }
        .auth-content {
            background-color: #f0f0f0;
            padding: 40px;
            border: 4px solid #000;
            border-radius: 10px;
            box-shadow: 8px 8px 0px #34495e;
            max-width: 400px;
            width: 90%;
            position: relative;
            text-align: center;
        }
        .auth-content h3 {
            font-family: 'Gagalin', cursive;
            color: #e74c3c;
            font-size: 2em;
        }
        .auth-content input {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 2px solid #000;
            border-radius: 5px;
        }
        .auth-content button {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Bebas Neue', sans-serif;
        }
        .auth-content button:hover {
            background-color: #2ecc71;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #000;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Nuova interfaccia Admin */
        #admin-panel {
            display: none; /* Nascosto di default */
            padding: 20px;
            max-width: 1200px;
            margin: auto;
        }
        .admin-header {
            background-color: #34495e;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 4px solid #000;
            border-bottom: none;
        }
        .admin-header h2 {
            margin: 0;
            color: #f1c40f;
            text-shadow: none;
        }
        .admin-header button {
            background-color: #e74c3c;
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            cursor: pointer;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .admin-header button:hover {
            background-color: #c0392b;
        }
        .admin-tabs {
            background-color: #5d6d7e;
            display: flex;
            border-bottom: 4px solid #000;
        }
        .admin-tabs button {
            background-color: #7f8c8d;
            color: white;
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.2em;
            transition: background-color 0.2s;
        }
        .admin-tabs button.active {
            background-color: #34495e;
        }
        .admin-content-section {
            background-color: #fff;
            padding: 30px;
            border: 4px solid #000;
            border-top: none;
            display: none;
        }
        .admin-content-section h3 {
            font-family: 'Gagalin', cursive;
            color: #c0392b;
            font-size: 1.8em;
            margin-bottom: 20px;
        }
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .admin-table th, .admin-table td {
            border: 1px solid #bdc3c7;
            padding: 12px;
            text-align: left;
        }
        .admin-table th {
            background-color: #34495e;
            color: white;
        }
        .admin-table td button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .admin-table td button:hover {
            background-color: #c0392b;
        }
        .add-product-form {
            display: grid;
            gap: 20px;
            text-align: left;
        }
        .add-product-form input, .add-product-form textarea, .add-product-form button {
            padding: 10px;
            border: 2px solid #000;
            border-radius: 5px;
        }
        .add-product-form button {
            background-color: #27ae60;
            color: white;
            cursor: pointer;
            font-size: 1.1em;
            font-family: 'Bebas Neue', sans-serif;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>Manbaga Comics & Games</h1>
        <div class="search-container">
            <input type="text" placeholder="Cerca un manga o una figure..." class="search-bar">
            <button class="search-btn">🔍</button>
        </div>
        <nav>
            <a href="#">Home</a>
            <a href="#">Manga</a>
            <a href="#">Figure</a>
            <a href="#booking-section">Prenota Tavolo</a>
            <a href="#" id="cart-btn">🛒 Carrello (<span id="cart-count">0</span>)</a>
            <a href="#" id="user-login-btn">Accedi / Registrati</a>
            <a href="#" id="admin-login-btn">Admin</a>
        </nav>
    </header>

    <main class="main-content">
        <h2>Prodotti in Evidenza</h2>
        <div class="product-grid" id="product-grid">
            </div>

        <div class="booking-section" id="booking-section">
            <h3>Prenota il tuo Tavolo da Gioco</h3>
            <p>I tavoli disponibili sono verdi. Clicca sul tavolo che vuoi prenotare.</p>
            <div class="table-grid">
                <div class="table available" data-table="1">Tavolo 1</div>
                <div class="table available" data-table="2">Tavolo 2</div>
                <div class="table available" data-table="3">Tavolo 3</div>
                <div class="table available" data-table="4">Tavolo 4</div>
                <div class="table available" data-table="5">Tavolo 5</div>
                <div class="table available" data-table="6">Tavolo 6</div>
                <div class="table available" data-table="7">Tavolo 7</div>
                <div class="table available" data-table="8">Tavolo 8</div>
            </div>
            
            <div class="booking-details" style="display: none;">
                <h4>Dettagli Prenotazione per Tavolo <span id="selected-table"></span></h4>
                <form class="booking-form" id="booking-form">
                    <div>
                        <label for="name">Nome:</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div>
                        <label for="surname">Cognome:</label>
                        <input type="text" id="surname" name="surname" required>
                    </div>
                    <div>
                        <label for="date">Data:</label>
                        <input type="date" id="date" name="date" required>
                    </div>
                    <div>
                        <label for="time">Orario:</label>
                        <input type="time" id="time" name="time" required>
                    </div>
                    <button type="submit">Conferma Prenotazione</button>
                </form>
            </div>
        </div>
    </main>

    <div id="admin-panel">
        <div class="admin-header">
            <h2>Pannello di Gestione Proprietario</h2>
            <button id="admin-logout-btn">Log Out</button>
        </div>
        <div class="admin-tabs">
            <button id="tab-reservations" class="active">Prenotazioni</button>
            <button id="tab-products">Prodotti</button>
        </div>

        <div id="reservations-section" class="admin-content-section" style="display: block;">
            <h3>Gestione Prenotazioni Tavoli</h3>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tavolo</th>
                        <th>Nome</th>
                        <th>Cognome</th>
                        <th>Data</th>
                        <th>Ora</th>
                        <th>Azione</th>
                    </tr>
                </thead>
                <tbody id="reservations-table-body">
                    </tbody>
            </table>
        </div>

        <div id="products-section" class="admin-content-section">
            <h3>Gestione Prodotti</h3>
            <h4>Aggiungi un nuovo prodotto</h4>
            <form id="add-product-form" class="add-product-form">
                <input type="text" id="new-product-title" placeholder="Titolo Prodotto" required>
                <input type="text" id="new-product-price" placeholder="Prezzo (es. 19.99)" required>
                <input type="text" id="new-product-image" placeholder="URL Immagine Principale" required>
                <button type="submit">Aggiungi Prodotto</button>
            </form>
            <h4 style="margin-top: 30px;">Prodotti esistenti</h4>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Titolo</th>
                        <th>Prezzo</th>
                        <th>Azione</th>
                    </tr>
                </thead>
                <tbody id="products-table-body">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="auth-modal" class="auth-modal">
        <div class="auth-content">
            <span class="close-btn">&times;</span>
            <div id="login-form">
                <h3>Accedi al tuo account</h3>
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <button id="login-submit-btn">Accedi</button>
                <p>Non hai un account? <a href="#" id="show-signup">Registrati qui</a></p>
            </div>
            <div id="signup-form" style="display: none;">
                <h3>Crea un nuovo account</h3>
                <input type="email" id="signup-email" placeholder="Email" required>
                <input type="password" id="signup-password" placeholder="Password" required>
                <button id="signup-submit-btn">Registrati</button>
                <p>Hai già un account? <a href="#" id="show-login">Accedi qui</a></p>
            </div>
            <div id="admin-login-form" style="display: none;">
                <h3>Accesso Proprietario</h3>
                <input type="text" id="admin-username" placeholder="Username" required>
                <input type="password" id="admin-password" placeholder="Password" required>
                <button id="admin-submit-btn">Accedi come Admin</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Manbaga Comics & Games. Tutti i diritti riservati.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Variabili di stato (simulazione di un database) ---
            const ADMIN_USERNAME = 'admin';
            const ADMIN_PASSWORD = '1234';
            let reservations = [];
            let products = [
                { id: 1, title: 'Jujutsu Kaisen Vol. 1', price: '12,90€', imageUrl: 'https://via.placeholder.com/300x400.png?text=Jujutsu+Kaisen+Vol.+1+FRONT' },
                { id: 2, title: 'Naruto Uzumaki - Figuarts', price: '49,99€', imageUrl: 'https://via.placeholder.com/300x400.png?text=Naruto+Figuarts+FRONT' },
                { id: 3, title: 'Chainsaw Man Vol. 5', price: '11,90€', imageUrl: 'https://via.placeholder.com/300x400.png?text=Chainsaw+Man+Vol.+5+FRONT' }
            ];

            // --- Selezione degli elementi DOM ---
            const cartCountElement = document.getElementById('cart-count');
            const userLoginBtn = document.getElementById('user-login-btn');
            const adminLoginBtn = document.getElementById('admin-login-btn');
            const authModal = document.getElementById('auth-modal');
            const closeBtn = document.querySelector('.close-btn');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const adminLoginForm = document.getElementById('admin-login-form');
            const showSignupLink = document.getElementById('show-signup');
            const showLoginLink = document.getElementById('show-login');
            const mainContent = document.querySelector('.main-content');
            const adminPanel = document.getElementById('admin-panel');
            const adminLogoutBtn = document.getElementById('admin-logout-btn');
            const tabReservations = document.getElementById('tab-reservations');
            const tabProducts = document.getElementById('tab-products');
            const reservationsSection = document.getElementById('reservations-section');
            const productsSection = document.getElementById('products-section');
            const reservationsTableBody = document.getElementById('reservations-table-body');
            const productsTableBody = document.getElementById('products-table-body');
            const addProductForm = document.getElementById('add-product-form');
            const productGrid = document.getElementById('product-grid');
            const tables = document.querySelectorAll('.table');
            const bookingDetailsSection = document.querySelector('.booking-details');
            const selectedTableSpan = document.getElementById('selected-table');
            const bookingForm = document.getElementById('booking-form');

            // --- Funzioni di gestione dell'interfaccia ---
            const renderProducts = () => {
                productGrid.innerHTML = '';
                products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <div class="product-gallery">
                            <img src="${product.imageUrl}" alt="${product.title}" class="main-image">
                            </div>
                        <h3>${product.title}</h3>
                        <p class="price">${product.price}</p>
                        <button class="add-to-cart-btn" data-id="${product.id}">Aggiungi al carrello</button>
                    `;
                    productGrid.appendChild(card);
                });
                attachCartListeners();
            };

            const attachCartListeners = () => {
                const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
                addToCartButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        let cartCount = parseInt(cartCountElement.textContent) || 0;
                        cartCount++;
                        cartCountElement.textContent = cartCount;
                        alert('Prodotto aggiunto al carrello!');
                    });
                });
            };

            const updateAdminProductTable = () => {
                productsTableBody.innerHTML = '';
                products.forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td>${product.title}</td>
                        <td>${product.price}</td>
                        <td>
                            <button class="edit-product-btn" data-id="${product.id}">Modifica</button>
                            <button class="delete-product-btn" data-id="${product.id}">Elimina</button>
                        </td>
                    `;
                    productsTableBody.appendChild(row);
                });
            };

            const updateAdminReservationsTable = () => {
                reservationsTableBody.innerHTML = '';
                reservations.forEach((res, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${res.table}</td>
                        <td>${res.name}</td>
                        <td>${res.surname}</td>
                        <td>${res.date}</td>
                        <td>${res.time}</td>
                        <td><button class="cancel-btn" data-index="${index}">Annulla</button></td>
                    `;
                    reservationsTableBody.appendChild(row);
                });
            };

            const showAdminPanel = () => {
                mainContent.style.display = 'none';
                adminPanel.style.display = 'block';
                // Mostra la sezione prenotazioni di default
                tabReservations.classList.add('active');
                reservationsSection.style.display = 'block';
                productsSection.style.display = 'none';
                updateAdminReservationsTable();
                updateAdminProductTable();
            };

            const hideAdminPanel = () => {
                mainContent.style.display = 'block';
                adminPanel.style.display = 'none';
            };

            // --- Event Listeners ---
            userLoginBtn.addEventListener('click', (e) => {
                e.preventDefault();
                authModal.style.display = 'flex';
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
                adminLoginForm.style.display = 'none';
            });
            
            adminLoginBtn.addEventListener('click', (e) => {
                e.preventDefault();
                authModal.style.display = 'flex';
                loginForm.style.display = 'none';
                signupForm.style.display = 'none';
                adminLoginForm.style.display = 'block';
            });

            closeBtn.addEventListener('click', () => {
                authModal.style.display = 'none';
            });

            showSignupLink.addEventListener('click', (e) => {
                e.preventDefault();
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
            });

            showLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                signupForm.style.display = 'none';
                loginForm.style.display = 'block';
            });

            document.getElementById('admin-submit-btn').addEventListener('click', () => {
                const username = document.getElementById('admin-username').value;
                const password = document.getElementById('admin-password').value;
                if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                    alert('Accesso proprietario riuscito! Benvenuto.');
                    authModal.style.display = 'none';
                    showAdminPanel();
                } else {
                    alert('Credenziali errate.');
                }
            });

            adminLogoutBtn.addEventListener('click', () => {
                hideAdminPanel();
                alert('Disconnessione effettuata.');
            });

            // Logica per le tab Admin
            tabReservations.addEventListener('click', () => {
                tabProducts.classList.remove('active');
                tabReservations.classList.add('active');
                productsSection.style.display = 'none';
                reservationsSection.style.display = 'block';
                updateAdminReservationsTable();
            });

            tabProducts.addEventListener('click', () => {
                tabReservations.classList.remove('active');
                tabProducts.classList.add('active');
                reservationsSection.style.display = 'none';
                productsSection.style.display = 'block';
                updateAdminProductTable();
            });

            // Gestione prenotazioni
            let selectedTable = null;
            tables.forEach(table => {
                table.addEventListener('click', () => {
                    if (table.classList.contains('booked')) {
                        alert('Questo tavolo è già prenotato. Per favore, scegline un altro.');
                        return;
                    }
                    tables.forEach(t => t.classList.remove('selected'));
                    table.classList.add('selected');
                    selectedTable = table.dataset.table;
                    selectedTableSpan.textContent = selectedTable;
                    bookingDetailsSection.style.display = 'block';
                });
            });

            bookingForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('name').value;
                const surname = document.getElementById('surname').value;
                const date = document.getElementById('date').value;
                const time = document.getElementById('time').value;

                if (selectedTable && name && surname && date && time) {
                    const bookedTableElement = document.querySelector(`.table[data-table="${selectedTable}"]`);
                    bookedTableElement.classList.remove('available', 'selected');
                    bookedTableElement.classList.add('booked');

                    const newReservation = { table: selectedTable, name, surname, date, time };
                    reservations.push(newReservation);
                    
                    bookingDetailsSection.style.display = 'none';
                    bookingForm.reset();
                    selectedTable = null;
                    alert(`Prenotazione confermata per il Tavolo ${newReservation.table} a nome di ${newReservation.name} ${newReservation.surname}!`);
                } else {
                    alert('Per favore, seleziona un tavolo e compila tutti i campi.');
                }
            });

            reservationsTableBody.addEventListener('click', (e) => {
                if (e.target.classList.contains('cancel-btn')) {
                    const index = e.target.dataset.index;
                    const cancelledReservation = reservations[index];
                    const tableToFree = document.querySelector(`.table[data-table="${cancelledReservation.table}"]`);

                    if (tableToFree) {
                        tableToFree.classList.remove('booked');
                        tableToFree.classList.add('available');
                    }
                    
                    reservations.splice(index, 1);
                    updateAdminReservationsTable();
                    alert(`La prenotazione per il Tavolo ${cancelledReservation.table} è stata annullata.`);
                }
            });

            // Gestione prodotti
            addProductForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newTitle = document.getElementById('new-product-title').value;
                const newPrice = document.getElementById('new-product-price').value;
                const newImage = document.getElementById('new-product-image').value;

                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({ id: newId, title: newTitle, price: newPrice + '€', imageUrl: newImage });
                addProductForm.reset();
                renderProducts();
                updateAdminProductTable();
                alert('Prodotto aggiunto con successo!');
            });

            productsTableBody.addEventListener('click', (e) => {
                const id = parseInt(e.target.dataset.id);
                if (e.target.classList.contains('delete-product-btn')) {
                    if (confirm('Sei sicuro di voler eliminare questo prodotto?')) {
                        products = products.filter(p => p.id !== id);
                        renderProducts();
                        updateAdminProductTable();
                        alert('Prodotto eliminato con successo.');
                    }
                }
                if (e.target.classList.contains('edit-product-btn')) {
                    const productToEdit = products.find(p => p.id === id);
                    const newTitle = prompt('Inserisci il nuovo titolo:', productToEdit.title);
                    if (newTitle !== null) {
                        productToEdit.title = newTitle;
                        const newPrice = prompt('Inserisci il nuovo prezzo:', productToEdit.price.replace('€', ''));
                        if (newPrice !== null) {
                            productToEdit.price = newPrice + '€';
                        }
                        renderProducts();
                        updateAdminProductTable();
                        alert('Prodotto modificato con successo.');
                    }
                }
            });

            // Avvia la pagina
            renderProducts();
        });
    </script>
</body>
</html>